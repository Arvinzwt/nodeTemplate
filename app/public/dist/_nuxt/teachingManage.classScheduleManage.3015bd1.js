(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{488:function(e,t,l){var content=l(511);"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,l(37).default)("61548822",content,!0,{sourceMap:!1})},496:function(e,t,l){"use strict";var n={name:"Pagination",data:function(){return{pagesMsg:{pageIndex:1,pageSize:1,count:0,pageSizes:[20,40,60,80]}}},computed:{pagesInfo:function(){return Object.assign(this.pagesMsg,this.model)}},model:{prop:"model",event:"update"},props:{model:{type:Object,default:function(){return{}}}},methods:{onCurrentPagesChange:function(e){var t=Object.assign(this.pagesInfo,{pageIndex:e});this.$emit("update",t),this.$emit("change",t)},onPagesSizeChange:function(e){var t=Object.assign(this.pagesInfo,{pageSize:e});this.$emit("update",t),this.$emit("change",t)}}},c=l(9),component=Object(c.a)(n,(function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"jr-pagination-wrapper"},[t("el-pagination",{attrs:{background:"","page-size":this.pagesInfo.pageSize,"current-page":this.pagesInfo.pageIndex,"page-sizes":this.pagesInfo.pageSizes,layout:"total,sizes, prev, pager, next, jumper",total:this.pagesInfo.count},on:{"current-change":this.onCurrentPagesChange,"size-change":this.onPagesSizeChange}})],1)}),[],!1,null,null,null);t.a=component.exports},510:function(e,t,l){"use strict";var n=l(488);l.n(n).a},511:function(e,t,l){(t=l(36)(!1)).push([e.i,'.jr-teachingManage-classScheduleManage .icon-box{font-size:12px}.jr-teachingManage-classScheduleManage .icon-box .icon{font-size:14px}.jr-teachingManage-classScheduleManage .icon-box .txt{margin-right:30px}.jr-teachingManage-classScheduleManage .table-item.disabled:after{content:"/"}',""]),e.exports=t},535:function(e,t,l){"use strict";l.r(t);l(10);var n=l(2),c={name:"classScheduleManage",components:{Pagination:l(496).a},computed:{options:function(){return this.$store.state.dicInfo},tableType:function(){return function(e){var t="";switch(e.type){case 0:t="disabled";break;case 1:t="";break;case 2:t="blue"}return t}}},data:function(){return{paramMap:{organizationId:"jr-gxh",cityCode:"",csId:"",csName:"",csType:"",date:[]},tableData:[{csId:0,cityCode:"string",cityName:"string",csName:"string",csNameExt:"string",csType:0,csTypeName:"string",basecsId:0,basecsName:"string",basecsNameExt:"string",dffectBeginDate:"2020-08-05T08:52:19.605Z",dffectEndDate:"2020-08-05T08:52:19.605Z",remark:"string",week:0,kssj:"2020-08-05T08:52:19.605Z",jssj:"2020-08-05T08:52:19.605Z",organizationId:"string",created_at:"2020-08-05T08:52:19.605Z",detailRemark:"string"}],dialog:{show:!1,type:null,title:"",form:{csId:null,cityCode:null,cityName:null,csName:null,csType:null,basecsId:null,dffectDate:[],classScheduleDetails:[]},rules:{}},city_list:[],pagesInfo:{}}},created:function(){var e=this;return Object(n.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.$api.common.deptList();case 2:e.city_list=t.sent,e.refreshPage();case 4:case"end":return t.stop()}}),t)})))()},methods:{refreshPage:function(){var e=this,t=this.paramMap;this.$api.teaching.classScheduleQuery({organizationId:t.organizationId,cityCode:t.cityCode,csId:t.csId,csName:t.csName,csType:t.csType,date:t.date}).then((function(t){console.log(t),e.tableData=t||[]})).catch((function(e){}))},submitSearch:function(){this.refreshPage()},clearSearch:function(){Object.assign(this.paramMap,{cityCode:"",csId:"",csName:"",csType:"",date:[]}),this.refreshPage()},addScheduleHandle:function(){var e=this;return Object(n.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.dialog.type=1,e.dialog.title="添加班表",t.t0=Object,t.t1=e.dialog.form,t.t2=[],t.next=7,e.getTableDetail([]);case 7:t.t3=t.sent,t.t4={csId:null,cityCode:null,cityName:null,csName:null,csType:null,basecsId:null,dffectDate:t.t2,classScheduleDetails:t.t3},t.t0.assign.call(t.t0,t.t1,t.t4),e.dialog.show=!0;case 11:case"end":return t.stop()}}),t)})))()},getTableDetail:function(e){return Object(n.a)(regeneratorRuntime.mark((function t(){var l,n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return l=["第一档","第二档","第三档","第四档","第五档","第六档","第七档"],n=["周一","周二","周三","周四","周五","周六","周日"],console.log(e,"arr"),t.abrupt("return",l.map((function(e){var t={gear:e};return n.forEach((function(e,l){t["z".concat(l+1)]={type:1,week:l+1,kssj:"",jssj:""}})),t})));case 4:case"end":return t.stop()}}),t)})))()},editScheduleHandle:function(e){var t=this;return Object(n.a)(regeneratorRuntime.mark((function l(){var n;return regeneratorRuntime.wrap((function(l){for(;;)switch(l.prev=l.next){case 0:return t.dialog.type=2,t.dialog.title="编辑班表",t.dialog.show=!0,l.next=5,t.$api.teaching.classScheduleQuery({organizationId:t.paramMap.organizationId,cityCode:null,csId:e.csId,csName:null,csType:null,date:null}).then((function(e){return e})).catch((function(e){}));case 5:return n=l.sent,l.t0=Object,l.t1=t.dialog.form,l.t2=e.csId,l.t3=e.cityCode,l.t4=e.cityName,l.t5=e.csName,l.t6=e.csType,l.t7=e.basecsId,l.t8=[e.dffectBeginDate,e.dffectEndDate],l.next=17,t.getTableDetail(n);case 17:l.t9=l.sent,l.t10={csId:l.t2,cityCode:l.t3,cityName:l.t4,csName:l.t5,csType:l.t6,basecsId:l.t7,dffectDate:l.t8,classScheduleDetails:l.t9},l.t0.assign.call(l.t0,l.t1,l.t10),t.dialog.show=!0;case 21:case"end":return l.stop()}}),l)})))()},closeDialog:function(){this.dialog.show=!1},submitDialog:function(){var e=this;this.$refs.filterForm.validate((function(t){var form=e.dialog.form,l={csId:form.csId,updater_id:e.$store.state.userInfo.userId,cityCode:form.cityCode,cityName:form.cityName,csName:form.csName,csType:form.csType,basecsId:form.basecsId,dffectBeginDate:e.$utils.convertTimestamp(form.dffectDate,0),dffectEndDate:e.$utils.convertTimestamp(form.dffectDate,1),remark:"",organizationId:"jr-gxh",creator_id:e.$store.state.userInfo.userId,classScheduleDetails:form.classScheduleDetails};if(!t)return!1;1===e.dialog.type?e.$api.teaching.addClassSchedule(l).then((function(t){e.$message.success("成功"),e.refreshPage(),e.closeDialog()})):2===e.dialog.type&&e.$api.teaching.modifyClassSchedule(l).then((function(t){e.$message.success("成功"),e.refreshPage(),e.closeDialog()}))}))},deleteScheduleHandle:function(e){var t=this;this.$confirm("确认删除该班表？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){t.$api.teaching.cancelClassSchedule({csId:e.csId,deleted_id:t.$store.state.userInfo.userId}).then((function(e){t.$message.success("删除成功")}))})).catch((function(){}))},onPagesChange:function(){this.refreshPage()},tableClick:function(e,t){var l=e["z".concat(t)].type;0!==l&&(e["z".concat(t)].type=1===l?2:1)}}},r=(l(510),l(9)),component=Object(r.a)(c,(function(){var e=this,t=e.$createElement,l=e._self._c||t;return l("el-main",{staticClass:"jr-teachingManage-classScheduleManage"},[l("h2",[e._v("班表管理")]),e._v(" "),l("el-form",{staticClass:"jr-filter-form",attrs:{size:"mini","label-width":"70px","label-position":"left"}},[l("el-row",{attrs:{gutter:18}},[l("el-col",{attrs:{span:6}},[l("el-form-item",{attrs:{label:"关联班表"}},[l("el-input",{attrs:{clearable:"",maxlength:"10",placeholder:"请输入"},model:{value:e.paramMap.csId,callback:function(t){e.$set(e.paramMap,"csId",t)},expression:"paramMap.csId"}})],1)],1),e._v(" "),l("el-col",{attrs:{span:6}},[l("el-form-item",{attrs:{label:"城市"}},[l("el-cascader",{attrs:{clearable:"",placeholder:"请选择",options:e.city_list},model:{value:e.paramMap.cityCode,callback:function(t){e.$set(e.paramMap,"cityCode",t)},expression:"paramMap.cityCode"}})],1)],1),e._v(" "),l("el-col",{attrs:{span:6}},[l("el-form-item",{attrs:{label:"班表名称"}},[l("el-input",{attrs:{clearable:"",maxlength:"10",placeholder:"请输入"},model:{value:e.paramMap.csName,callback:function(t){e.$set(e.paramMap,"csName",t)},expression:"paramMap.csName"}})],1)],1),e._v(" "),l("el-col",{attrs:{span:6}},[l("el-form-item",{attrs:{label:"班表类型"}},[l("el-select",{attrs:{placeholder:"请选择"},model:{value:e.paramMap.csType,callback:function(t){e.$set(e.paramMap,"csType",t)},expression:"paramMap.csType"}},e._l(e.options.class_schedule_type,(function(e){return l("el-option",{key:e.dicValue,attrs:{label:e.name,value:e.dicValue}})})),1)],1)],1)],1),e._v(" "),l("el-row",{attrs:{gutter:18}},[l("el-col",{attrs:{span:6}},[l("el-form-item",{attrs:{label:"生效时间"}},[l("el-date-picker",{attrs:{type:"daterange","unlink-panels":"","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期"},model:{value:e.paramMap.date,callback:function(t){e.$set(e.paramMap,"date",t)},expression:"paramMap.date"}})],1)],1),e._v(" "),l("el-col",{attrs:{span:6}},[l("el-form-item",{attrs:{label:"","label-width":"0"}},[l("el-button",{attrs:{type:"primary"},on:{click:e.submitSearch}},[e._v("查询")]),e._v(" "),l("el-button",{on:{click:e.clearSearch}},[e._v("清空")])],1)],1)],1)],1),e._v(" "),l("div",{staticClass:"action bar t-right mar-t-30"},[l("el-button",{attrs:{size:"mini",type:"primary"},on:{click:e.addScheduleHandle}},[e._v("+班表")])],1),e._v(" "),l("el-table",{ref:"filterTable",staticClass:"jr-table",attrs:{"cell-class-name":"jr-table_cell","header-cell-class-name":"jr-table_header",data:e.tableData,size:"mini"}},[l("el-table-column",{attrs:{label:"班表名称"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n                "+e._s(t.row.cityName)+"-"+e._s(t.row.csName)+"\n            ")]}}])}),e._v(" "),l("el-table-column",{attrs:{label:"班表类型",prop:"csTypeName"}}),e._v(" "),l("el-table-column",{attrs:{label:"生效时间"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n                "+e._s(e.$utils.convertDate(t.row.dffectBeginDate,"YYYY-MM-DD"))+"~\n                "+e._s(e.$utils.convertDate(t.row.dffectEndDate,"YYYY-MM-DD"))+"\n            ")]}}])}),e._v(" "),l("el-table-column",{attrs:{label:"关联的班表",prop:"basecsName"}}),e._v(" "),l("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[l("el-link",{attrs:{type:"primary"},on:{click:function(l){return e.editScheduleHandle(t.row)}}},[e._v("编辑")]),e._v(" "),l("el-link",{attrs:{type:"primary"},on:{click:function(l){return e.deleteScheduleHandle(t.row)}}},[e._v("删除")])]}}])})],1),e._v(" "),l("Pagination",{on:{change:e.onPagesChange},model:{value:e.pagesInfo,callback:function(t){e.pagesInfo=t},expression:"pagesInfo"}}),e._v(" "),l("el-dialog",{staticClass:"jr-KnowledgeTree-dialog",attrs:{modal:"","close-on-click-modal":!1,"close-on-press-escape":!1,"show-close":!1,width:"800px",title:e.dialog.title,visible:e.dialog.show},on:{"update:visible":function(t){return e.$set(e.dialog,"show",t)}}},[l("el-form",{ref:"filterForm",staticClass:"jr-filter-form",attrs:{size:"mini","label-width":"70px","label-position":"left",model:e.dialog.form,rules:e.dialog.rules}},[l("el-form-item",{attrs:{label:"班表类型",prop:"csType"}},[l("el-radio-group",{model:{value:e.dialog.form.csType,callback:function(t){e.$set(e.dialog.form,"csType",t)},expression:"dialog.form.csType"}},e._l(e.options.class_schedule_type,(function(t){return l("el-radio",{key:t.dicValue,attrs:{label:t.dicValue}},[e._v("\n                        "+e._s(t.name)+"\n                    ")])})),1)],1),e._v(" "),l("el-row",{attrs:{gutter:18}},[l("el-col",{attrs:{span:12}},[l("el-form-item",{attrs:{label:"城市名称",prop:"cityCode"}},[l("el-cascader",{attrs:{clearable:"",placeholder:"请选择",options:e.city_list},model:{value:e.dialog.form.cityCode,callback:function(t){e.$set(e.dialog.form,"cityCode",t)},expression:"dialog.form.cityCode"}})],1)],1),e._v(" "),l("el-col",{attrs:{span:12}},[l("el-form-item",{attrs:{label:"班表名称",prop:"csName"}},[l("el-input",{attrs:{placeholder:"请输入"},model:{value:e.dialog.form.csName,callback:function(t){e.$set(e.dialog.form,"csName",t)},expression:"dialog.form.csName"}})],1)],1)],1),e._v(" "),"2"===e.dialog.form.csType?l("el-row",{attrs:{gutter:18}},[l("el-col",{attrs:{span:12}},[l("el-form-item",{attrs:{label:"关联班表",prop:"basecsId"}},[l("el-select",{attrs:{placeholder:"请选择"},model:{value:e.dialog.form.basecsId,callback:function(t){e.$set(e.dialog.form,"basecsId",t)},expression:"dialog.form.basecsId"}},e._l(e.options.class_schedule_type,(function(e){return l("el-option",{key:e.dicValue,attrs:{label:e.name,value:e.dicValue}})})),1)],1)],1),e._v(" "),l("el-col",{attrs:{span:12}},[l("el-form-item",{attrs:{label:"生效日期",prop:"dffectDate"}},[l("el-date-picker",{attrs:{type:"daterange","unlink-panels":"","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期"},model:{value:e.dialog.form.dffectDate,callback:function(t){e.$set(e.dialog.form,"dffectDate",t)},expression:"dialog.form.dffectDate"}})],1)],1)],1):e._e(),e._v(" "),l("el-table",{ref:"filterTable",staticClass:"jr-table blank-table",attrs:{"cell-class-name":"jr-table_cell","header-cell-class-name":"jr-table_header",data:e.dialog.form.classScheduleDetails,border:"",size:"mini"}},[l("el-table-column",{attrs:{align:"center",label:"时段",prop:"gear"},scopedSlots:e._u([{key:"default",fn:function(t){return[l("div",{staticClass:"table-box"},[l("div",{staticClass:"table-item"},[e._v(e._s(t.row.gear))])])]}}])}),e._v(" "),l("el-table-column",{attrs:{align:"center",label:"周一"},scopedSlots:e._u([{key:"default",fn:function(t){return[l("div",{staticClass:"table-item",class:e.tableType(t.row.z1),on:{click:function(l){return e.tableClick(t.row,1)}}})]}}])}),e._v(" "),l("el-table-column",{attrs:{align:"center",label:"周二"},scopedSlots:e._u([{key:"default",fn:function(t){return[l("div",{staticClass:"table-item",class:e.tableType(t.row.z2),on:{click:function(l){return e.tableClick(t.row,2)}}})]}}])}),e._v(" "),l("el-table-column",{attrs:{align:"center",label:"周三"},scopedSlots:e._u([{key:"default",fn:function(t){return[l("div",{staticClass:"table-item",class:e.tableType(t.row.z3),on:{click:function(l){return e.tableClick(t.row,3)}}})]}}])}),e._v(" "),l("el-table-column",{attrs:{align:"center",label:"周四"},scopedSlots:e._u([{key:"default",fn:function(t){return[l("div",{staticClass:"table-item",class:e.tableType(t.row.z4),on:{click:function(l){return e.tableClick(t.row,4)}}})]}}])}),e._v(" "),l("el-table-column",{attrs:{align:"center",label:"周五"},scopedSlots:e._u([{key:"default",fn:function(t){return[l("div",{staticClass:"table-item",class:e.tableType(t.row.z5),on:{click:function(l){return e.tableClick(t.row,5)}}})]}}])}),e._v(" "),l("el-table-column",{attrs:{align:"center",label:"周六"},scopedSlots:e._u([{key:"default",fn:function(t){return[l("div",{staticClass:"table-item",class:e.tableType(t.row.z6),on:{click:function(l){return e.tableClick(t.row,6)}}})]}}])}),e._v(" "),l("el-table-column",{attrs:{align:"center",label:"周日"},scopedSlots:e._u([{key:"default",fn:function(t){return[l("div",{staticClass:"table-item",class:e.tableType(t.row.z7),on:{click:function(l){return e.tableClick(t.row,7)}}})]}}])})],1),e._v(" "),l("div",{staticClass:"icon-box"},[l("span",{staticClass:"icon color-gray el-icon-s-opportunity"}),e._v(" "),l("span",{staticClass:"txt "},[e._v("可排课")]),e._v(" "),l("span",{staticClass:"icon"},[e._v("/")]),e._v(" "),l("span",{staticClass:"txt"},[e._v("不可排课")]),e._v(" "),l("span",{staticClass:"icon color-blue el-icon-s-opportunity"}),e._v(" "),l("span",{staticClass:"txt"},[e._v("已排课")])])],1),e._v(" "),l("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[l("el-button",{attrs:{size:"mini"},on:{click:e.closeDialog}},[e._v("取 消")]),e._v(" "),l("el-button",{attrs:{size:"mini",type:"primary"},on:{click:e.submitDialog}},[e._v("提 交")])],1)],1)],1)}),[],!1,null,null,null);t.default=component.exports}}]);